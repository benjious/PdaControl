package com.benjious.pdacontrol.encryption;

import java.io.File;
import java.io.InputStream;
import java.security.Key;
import java.security.KeyPair;


/**
 * ?????????????????????/????????????/???????????????
 * ????/????????????????????????
 * ???????/????????????????????
 *
 * @author wanna
 */
public interface AsymmetryEncrypt extends Encryption {
    /**
     * ???????
     *
     * @param file ?????????
     * @param key  ?????????
     * @return ????????????????????????.fjm????????file???
     * ???? ????  ??F:\1.txt
     * ????  ??F:\1.txt.fjm
     * @throws Exception
     */
    public File encrypt(File file, Key key) throws Exception;

    /**
     * ???? ??????????????????????????????????????????????????cipherPath???????
     *
     * @param plainText  ??????
     * @param key        ???????????
     * @param cipherPath ???????????????????????
     * @return ?????????????????????????
     * @throws Exception
     */
    public File encrypt(InputStream plainText, Key key, String cipherPath) throws Exception;

    /**
     * ????
     *
     * @param cipherText ?????????????????????
     * @param key        ???????????
     * @return ???????????????
     * @throws Exception
     */
    public String decrypt(byte[] cipherText, Key key) throws Exception;

    /**
     * ??????????????????
     *
     * @param cipherText ?????????
     * @param key        ???????????
     * @return ?????????
     * @throws Exception
     */
    public String decrypt(String cipherText, Key key) throws Exception;

    /**
     * ?????????????.fjm?????????????????
     *
     * @param cipherFile ??????????????????????.fjm
     * @param key        ???????????
     * @return ????????????????
     * ?? ??cipherFile ? F:\1.txt.fjm
     * ?????        F:\1.txt    ??????????
     * @throws Exception
     */
    public File decrypt(File cipherFile, Key key) throws Exception;

    /**
     * ???? ????????????????????
     *
     * @param cipherText ???????????????????
     * @param key        ???????????
     * @param plainPath  ??????????????????????
     * @return ?????????????????????????
     * @throws Exception
     */
    public File decrypt(InputStream cipherText, Key key, String plainPath) throws Exception;

    /**
     * ???????
     *
     * @param plainText ?????????
     * @param key       ??????????
     * @return ??????????????
     * @throws Exception
     */
    public String digitalSignature(String plainText, Key key) throws Exception;

    /**
     * ??????
     *
     * @param plainText   ?????????
     * @param signMessage ??????
     * @param key         ??????????
     * @return ??????
     * true  ??????
     * false ???????
     * @throws Exception
     */
    public boolean validateSignature(String plainText, String signMessage, Key key) throws Exception;

    /**
     * ???????
     *
     * @param file ????????
     * @param key  ??????????
     * @return ???????????????,??????.sig
     * ?? file       F:\1.txt
     * ?????????   F:\1.txt.sig
     * @throws Exception
     */
    public File digitalSignature(File file, Key key) throws Exception;

    /**
     * ??????
     *
     * @param plainText   ????
     * @param signMessage ???????????????????????.sig
     * @param key         ???????????
     * @return ??????
     * true  ??????
     * false ???????
     * @throws Exception
     */
    public boolean validateSignature(File plainText, File signMessage, Key key) throws Exception;

    /**
     * ???????
     *
     * @param plainStream ????????????????????
     * @param key         ??????????????
     * @param signPath    ??????????????????????
     * @return ???????????????
     * @throws Exception
     */
    public File digitalSignature(InputStream plainStream, Key key, String signPath) throws Exception;

    /**
     * ??????
     *
     * @param plainStream ???????????????????
     * @param signStream  ??????????????????
     * @param key         ?????????????
     * @return
     * @throws Exception
     */
    public boolean validateSignature(InputStream plainStream, InputStream signStream, Key key) throws Exception;

    /**
     * ??????
     *
     * @return
     * @throws Exception
     */
    public Key getPublicKey() throws Exception;

    /**
     * ?????
     *
     * @return
     * @throws Exception
     */
    public Key getPrivateKey() throws Exception;

    /**
     * ????????????????
     *
     * @return
     * @throws Exception
     */
    public KeyPair getKeyPair() throws Exception;


}
